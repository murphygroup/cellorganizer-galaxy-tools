<tool id="slml2img" name="Generates a synthetic image" version="0.0.1">
<!--
 Copyright (C) 2007-2017 Murphy Lab
 Lane Center for Computational Biology
 School of Computer Science
 Carnegie Mellon University

 This program is free software; you can redistribute it and/or modify
 it under the terms of the GNU General Public License as published
 by the Free Software Foundation; either version 2 of the License,
 or (at your option) any later version.

 This program is distributed in the hope that it will be useful, but
 WITHOUT ANY WARRANTY; without even the implied warranty of
 MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
 General Public License for more details.

 You should have received a copy of the GNU General Public License
 along with this program; if not, write to the Free Software
 Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA
 02110-1301, USA.

 For additional information visit http://murphylab.web.cmu.edu or
 send email to murphy@cmu.edu
-->
  <description>from a valid SLML model.</description>
  <command>
    echo -e "tic;
    current_directory = pwd;
    cellorganizer_directory = getenv('CELLORGANIZER');
    cd( cellorganizer_directory );
    setup();
    cd( current_directory );
    options.seed = $other_options.seed;
    state = rng( options.seed );
    options.targetDirectory = current_directory;
    options.prefix = 'imgs';
    options.compression = '$other_options.compression';
    options.sampling.method = '$options_sample_method';
    options.debug = false;
    options.display = false;
    options.synthesis = '$options_synthesis';
    options.output.tifimages = false;
    options.output.OMETIFF = true;
    options.numberOfSynthesizedImages = 1;
    check_if_files_exist_on_disk_and_link_them_mat('$dataset');
    files = dir( [ pwd filesep '*.mat']);
    filenames = {};
    for i=1:length(files) filenames{length(filenames)+1}=[pwd filesep files(i).name]; end;
    #for $field in $advanced_options.option
      options.${field.name}=${field.value};
    #end for
    diary diary.txt;
    answer = slml2img(filenames, options);
    diary off;
    toc;
    exit;" > script.m;
    cat script.m;
    if [ ! -d $output.extra_files_path ]; then mkdir $output.extra_files_path; fi;
    cp script.m $output.extra_files_path;
    bash $__tool_directory__/slml2img.sh "$output.extra_files_path/script.m";
  </command>
  <inputs>
    <!-- select datasets -->
    <param name="dataset" format="mat" type="data" multiple="true" label="Select models(s)" min="1" max="10"/>

    <!-- synthesis option -->
    <param name="options_synthesis" type="select" label="Synthesis option">
      <option value="nucleus">nucleus</option>
      <option value="framework">framework</option>
      <option value="all" selected="true">all</option>
    </param>
    <!--
    <section name="dimensionality" title="Dimensionality Options" expanded="True">
      <conditional name="dimensionality">
        <param name="dimensionality" type="select" label="dimensionality">
          <option value="2D" selected="true">2D</option>
          <option value="3D">3D</option>
        </param>
        <when value="2D">
          <param name="options_spherical_cell" type="boolean" label="spherical_cell" checked="true" />
        </when>
        <when value="3D">
          <param name="options_microscope" type="select" label="options.microscope">
            <option value="none" selected="true">None</option>
            <option value="SVI">SVI</option>
	  </param>
	  </when>
	  </conditional>
	  <section>
-->
    <!-- Microscope option -->
    <param name="options_microscope" type="select" label="options.microscope">
	<option value="none" selected="true"> None </option>
	<option value="SVI"> SVI </option>
    </param>

    <!-- Sampling option -->
    <param name="options_sample_method" type="select" label="options.sample.method">
	<option value="disc" selected="true">disc</option>
	<option value="sampled">sampled</option>
    </param>
    
    <section name="other_options" title="Other options" expanded="False">
      <!-- output options -->
      <param name="options.tifimages" type="boolean" label="Write TIF image(s)" checked="true" />
      <param name="options.indexedimage" type="boolean" label="Write indexed image(s)" checked="false" />
      <param name="options.blenderfile" type="boolean" label="Write Blender file(s)" checked="false" />
      <param name="options.SBML" type="boolean" label="Write SBML instance(s)" checked="false" />

      <!-- seed for random number generator -->
      <param name="seed" type="integer" value="3" label="Seed for pseudo-random number generator"/>

      <!-- number of synthesized images 
      <param name="number_of_synthesized_images" type="integer" value="1" label="Number of synthesized images"/>
	-->
      <!-- image compression -->
      <param name="compression" type="select" label="Image compression">
        <option value="lzw" selected="true">LZW</option>
        <option value="none">No compression</option>
      </param>
      <param name="options_debug" type="boolean" label="Debug mode" checked="false" />
      <param name="options_display" type="boolean" label="Display mode" checked="false" />
      <param name="options_verbose" type="boolean" label="Verbose mode" checked="false" />
      <param name="options_output_tifimages" type="boolean" label="Output TIFF" checked="false" />
      <param name="options_output_OMETIFF" type="boolean" label="Output OMETIFF" checked="true" />
    </section>
    <section name="advanced_options" title="Advanced options" expanded="false">
      <repeat name="option" title="Options">
        <param name="name" type="text" label="Name"> </param>
        <param name="value" type="text" label="Value"></param>
      </repeat>
    </section>
  </inputs>
  <outputs>
    <data format="tiff" name="output" from_work_dir="cell1.ome.tif"/>
  </outputs>
<help>

**Description**

Synthesize image(s) from generative models trained using CellOrganizer.

-----

**Input**

A generative model.

-----

**Output**

One or more images.

</help>
</tool>
